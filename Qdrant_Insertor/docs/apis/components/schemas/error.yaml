# Error Schemas

ErrorResponse:
  type: object
  description: |
    标准错误响应对象，用于统一API错误信息的格式和结构。
    
    ## 错误处理原则
    
    所有API错误都遵循统一的响应格式：
    - **一致性**: 所有错误使用相同的结构
    - **可读性**: 提供人类可读的错误信息
    - **可编程性**: 提供机器可处理的错误码
    - **详细性**: 可选提供额外的错误详情
    
    ## 错误分类
    
    常见错误类型包括：
    - **客户端错误**: 4xx状态码，请求参数或格式问题
    - **服务器错误**: 5xx状态码，系统内部问题
    - **验证错误**: 请求参数验证失败
    - **资源错误**: 请求的资源不存在或无权访问
    
    ## 错误处理最佳实践
    
    - **错误码**: 使用标准化的错误码进行程序处理
    - **用户信息**: 显示message字段给最终用户
    - **调试信息**: 使用details字段提供调试信息
    - **日志记录**: 记录完整的错误信息用于排查
    
    ## 使用场景
    
    - **API调用失败**: 客户端处理API调用失败情况
    - **错误展示**: 在用户界面显示友好的错误信息
    - **调试排查**: 开发者使用错误信息进行问题排查
    - **自动化处理**: 程序根据错误码进行自动化处理
  properties:
    error:
      type: object
      description: |
        错误对象，包含错误的所有相关信息。
        
        **结构**: 包含错误码、消息和可选的详细信息
        **用途**: 提供完整的错误上下文
        **一致性**: 所有API错误都使用此结构
      properties:
        code:
          type: string
          description: |
            标准化的错误码，用于程序化处理错误。
            
            **格式**: 大写字母和下划线的组合
            **用途**: 客户端程序可以根据错误码进行特定处理
            **标准化**: 相同类型的错误使用相同的错误码
            
            **常见错误码**:
            - VALIDATION_ERROR: 请求参数验证失败
            - NOT_FOUND: 请求的资源不存在
            - BAD_REQUEST: 请求格式或参数错误
            - UNAUTHORIZED: 未授权访问
            - FORBIDDEN: 禁止访问
            - INTERNAL_ERROR: 服务器内部错误
            - FILE_TOO_LARGE: 文件大小超出限制
          example: "VALIDATION_ERROR"
        message:
          type: string
          description: |
            人类可读的错误信息，用于向用户展示。
            
            **语言**: 通常使用中文（根据系统配置）
            **用途**: 直接显示给最终用户
            **格式**: 简洁明了的错误描述
            **本地化**: 可能根据用户偏好语言进行本地化
            
            **注意**: 此信息主要用于展示，不应依赖其进行程序化处理
          example: "字段 'q' 是必需的"
        details:
          type: object
          description: |
            错误的额外详细信息，提供更具体的错误上下文。
            
            **内容**: 包含错误相关的具体字段、值等信息
            **用途**: 提供调试和排查问题的详细信息
            **可选性**: 可选字段，不是所有错误都会提供
            **结构**: 键值对形式，具体内容因错误类型而异
            
            **常见内容**:
            - field: 出错的字段名
            - value: 出错的字段值
            - reason: 错误的具体原因
            - constraint: 违反的约束条件
            - expected: 期望的值或格式
            - actual: 实际的值或格式
          additionalProperties: true
          example:
            field: "q"
            reason: "查询参数不能为空"
            constraint: "required"
      required:
        - code
        - message
  required:
    - error