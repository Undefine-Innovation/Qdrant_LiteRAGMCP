# 4.1 表现层（Web UI）

## 2.1 概述

表现层（Presentation Layer），即 Web UI，是用户与系统进行交互的界面。它负责展示信息、接收用户输入，并通过调用后端 API 层来完成业务操作。本层采用单页应用（SPA）架构，旨在提供流畅、响应式的用户体验。

## 2.2 模块列表

- **Web UI 应用**：基于现代前端框架构建的单页应用。

## 2.3 模块详情

### 2.3.1 Web UI 应用

#### 2.3.1.1 职责

- **用户界面渲染**：根据后端数据和用户操作，动态渲染页面内容。
- **用户交互处理**：响应用户的点击、输入等操作，并进行相应的逻辑处理。
- **API 调用**：通过 HTTP 请求与后端 API 层进行数据交互。
- **状态管理**：管理前端应用的状态，确保数据一致性。
- **身份验证与授权**：处理用户登录、会话管理，并根据用户权限控制界面元素的可见性。
- **文件上传与管理**：提供用户上传文档、查看文档列表、删除文档等功能。
- **搜索结果展示**：将后端返回的检索结果以友好的方式呈现给用户。

#### 2.3.1.2 接口与数据流

- **对外接口**：
  - 通过浏览器提供用户可访问的 Web 界面。
- **对内接口（与 API 层交互）**：
  - **HTTP/RESTful 或 GraphQL API**：通过标准的 HTTP 请求与后端 API 进行通信。
  - **数据格式**：通常使用 JSON 进行数据传输。
  - **主要交互流程**：
    - **文件上传**：`POST /upload` (multipart/form-data)
    - **文档删除**：`DELETE /doc/:id`
    - **查询文档 Chunk 列表**：`GET /doc/:id/chunks`
    - **向量检索**：`GET /search?q=...`
    - **健康检查**：`GET /healthz`
    - **Prometheus 指标**：`GET /metrics` (可选)

#### 2.3.1.3 关键实现与技术栈

- **技术栈**：Vue / React / Svelte (选择其中之一作为主框架)。
- **状态管理**：根据所选框架，可能使用 Vuex / Pinia (Vue), Redux / Zustand (React), Svelte stores (Svelte) 等。
- **路由管理**：Vue Router (Vue), React Router (React), S客户端路由 (Svelte) 等。
- **HTTP 客户端**：Axios, Fetch API 等。
- **构建工具**：Vite, Webpack 等。
- **UI 组件库**：Element UI, Ant Design, Material UI 等 (可选)。

#### 2.3.1.4 开发需求与约定

- **编码规范**：
  - 遵循前端框架官方推荐的编码风格指南。
  - 使用 ESLint 和 Prettier 进行代码格式化和规范检查。
  - 组件化开发，确保组件职责单一、可复用。
  - 语义化 HTML、模块化 CSS (如 CSS Modules, Styled Components)。
- **错误处理**：
  - 统一的错误提示机制，通过 UI 反馈给用户。
  - 对 API 请求进行错误捕获，并根据后端返回的错误码进行相应处理。
  - 前端日志记录，便于调试和问题追踪。
- **测试策略**：
  - **单元测试**：仅在必要时对核心业务逻辑或复杂工具函数进行单元测试。
  - **集成测试**：优先测试涉及具体业务流程的功能，确保组件间交互和页面流程的正确性 (如 React Testing Library, Vue Test Utils)。
  - **端到端测试 (E2E)**：使用 Playwright 或 Cypress 模拟用户关键行为，覆盖主要用户路径。
- **依赖管理**：
  - 使用 npm 或 yarn 管理前端依赖。
  - 定期更新依赖，并进行安全漏洞扫描。
- **性能考量**：
  - 优化前端资源加载，如代码分割、图片懒加载。
  - 减少不必要的渲染，利用虚拟列表等技术优化大数据量展示。
  - 关注 Lighthouse 等性能指标，持续优化用户体验。
- **安全考量**：
  - 防止 XSS、CSRF 等常见的 Web 安全漏洞。
  - 敏感数据不在前端直接存储，或进行加密处理。
  - API 请求中包含必要的认证信息 (如 JWT Token)。
