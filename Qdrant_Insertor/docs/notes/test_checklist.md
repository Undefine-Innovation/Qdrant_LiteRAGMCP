# 测试清单草稿

本文档提供了一个初步的测试清单草稿，用于指导项目开发过程中的测试活动。此清单将随着项目进展和具体功能实现而逐步完善。

## 1. 单元测试 (Unit Tests)

- **目标**：验证单个函数、类或模块的独立功能是否正确。
- **覆盖范围**：
  - **核心业务逻辑**：领域层中的 `Retriever`, `FusionStrategy`, `GraphExtractor` 等。
  - **工具函数**：`id` 生成、哈希计算、日期格式化等。
  - **数据校验**：`Zod Schema` 的校验逻辑。
  - **状态机逻辑**：`SyncStateMachine` 的状态转移和事件处理。
- **工具**：Jest, Vitest

## 2. 集成测试 (Integration Tests)

- **目标**：验证不同模块或组件之间的交互是否正确。
- **覆盖范围**：
  - **API 层**：
    - 验证 API 端点是否正确路由到 Controller。
    - 验证 DTO 校验是否生效。
    - 验证 Controller 是否正确调用 Service 并封装响应。
  - **应用层服务**：
    - `ImportService`：验证文件上传、切片、向量化、入库的完整流程。
    - `SearchService`：验证搜索查询、检索、结果融合的完整流程。
    - `AutoGC`：验证数据一致性检查和清理逻辑。
  - **数据存储交互**：
    - `SQLiteRepo` 与 SQLite 数据库的交互。
    - `QdrantRepo` 与 Qdrant 数据库的交互。
- **工具**：Jest, Supertest (用于 API 测试)

## 3. 端到端测试 (End-to-End Tests / E2E)

- **目标**：模拟真实用户场景，验证整个系统（包括前端和后端）的功能是否按预期工作。
- **覆盖范围**：
  - **用户注册/登录** (如果存在)。
  - **文档上传**：从前端上传文件到后端处理完成。
  - **文档搜索**：从前端输入查询到后端返回结果并在前端展示。
  - **文档管理**：查看、删除文档等。
  - **健康检查**：验证 `/healthz` 端点。
- **工具**：Playwright, Cypress

## 4. 性能测试 (Performance Tests)

- **目标**：评估系统在不同负载下的性能表现，验证是否达到性能目标。
- **覆盖范围**：
  - **API 吞吐量 (QPS)**：测试 `/upload`, `/search` 等核心 API 的每秒请求数。
  - **API 延迟 (Latency)**：测试核心 API 的平均延迟、P95、P99 延迟。
  - **资源利用率**：CPU、内存、网络带宽等。
  - **并发用户数**：模拟多用户同时操作。
- **工具**：JMeter, k6, Artillery

## 5. 安全测试 (Security Tests)

- **目标**：识别系统中的安全漏洞。
- **覆盖范围**：
  - **认证与授权**：测试 JWT/Cookie 的安全性，权限控制是否正确。
  - **输入验证**：防止 SQL 注入、XSS、CSRF 等攻击。
  - **敏感数据保护**：数据加密、访问控制。
- **工具**：OWASP ZAP, Burp Suite (手动或自动化)

## 6. 可用性测试 (Usability Tests)

- **目标**：评估用户界面的易用性和用户体验。
- **覆盖范围**：
  - 用户界面导航。
  - 表单填写。
  - 错误提示。
- **工具**：用户访谈、可用性测试平台

## 7. 兼容性测试 (Compatibility Tests)

- **目标**：确保系统在不同环境下的兼容性。
- **覆盖范围**：
  - **浏览器兼容性**：Chrome, Firefox, Edge, Safari。
  - **操作系统兼容性**：Windows, macOS, Linux (如果前端有桌面应用)。
  - **设备兼容性**：桌面、移动设备。
- **工具**：BrowserStack, Sauce Labs
